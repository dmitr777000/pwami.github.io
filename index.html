<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
   <!--  <script  defer></script><!--  -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page title</title>
</head>
<body>
    <h1 >датаa </h1>
    <button style="margin-left: auto">заново</button>
    <button>зарегить</button>
    <div></div>
    <button style="display:none" >вторай</button>
    <p></p>
    </body>
    </html>
    <!-- <script src="db.js"> -->
        <script>
            
const h1 =document.querySelector("h1");
const options = { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' };
const today = new Date();
const rut = today.toLocaleDateString('ru-RU', options);
const divv  =document.querySelector("div");
const button =document.querySelector("button:nth-of-type(1)");
const button2=document.querySelector("button:nth-of-type(2)");
const table  =document.querySelector("p")
            h1.textContent = rut;

 const request = indexedDB.open('MyDatabse', 1);
   
request.onupgradeneeded = event => 
        {
const db = event.target.result; 
db.createObjectStore('dat', { autoIncrement: true });
  alert("создана новая база");
          }
            
request.onsuccess = event => 
         {
         const db = event.target.result; 
 const transaction = db.transaction('dat', 'readwrite');
const store = transaction.objectStore('dat');

const getAllRequest = store.getAll();  
getAllRequest.onerror = () => alert(`ошибка чтения`);
               
getAllRequest.onsuccess = () =>
               {
      const allRecords = getAllRequest.result ;
table.style.background = "PaleGreen";
let list = '<ul>';
for (let i = 0; i < allRecords.length; i++) {
            const vvalue =allRecords[i] ;
            list += `<li><strong>${vvalue}</strong></li>`;
                        }
        list += '</ul>';
        table.innerHTML = list+"конец";
                }
          }
          
button.addEventListener('click',()=> 
     {
         table.remove();
       h1.textContent =`вы уверены?`;
              divv.style.height = "200px";
              divv.style.background = "maroon";
              divv.style.marginBottom = "40px";
 button.remove();
button2.textContent =`дааа!, ,${rut}`;
button2.style.display ="";
        }
                        );
            
            
button2.addEventListener('click',()=>     
    {
divv.style.height = "";
button2.remove();
h1.textContent=" ошибка аааа";

const request = indexedDB.open('MyDatabse', 1);
request.onsuccess = event => 
         {
         const db = event.target.result; 
  const transaction = db.transaction('dat', 'readwrite');
  const store = transaction.objectStore('dat');
  store.add(rut);
  const getAllRequest = store.getAll();
                  
  
  getAllRequest.onsuccess = () =>
       {
      const allRecords = getAllRequest.result;
h1.textContent =`УсПех !!`;
document.querySelector("div").style.background = "PaleGreen";
let list = '<ul>';
        for (let i = 0; i < allRecords.length; i++) {
            const vvalue =allRecords[i] ;
            list += `<li><strong>${vvalue}</strong></li>`;
                        }
        list += '</ul>';
        document.querySelector("div").innerHTML = list+"конец";
        }
       
        
                }        
    });

        </script>

</body>
</html>
